var $ = $.noConflict();
$(function () {
  "use strict";

  if ($(".navbar").width() > 1007) {
    $('.nav .dropdown').hover(function () {
      $(this).addClass('open');
    }, function () {
      $(this).removeClass('open');
    });
  };
  // site preloader
  //preloader
  $(window).preloader({
    delay: 500
  });

  $(".search-nav a,.close-search").on("click", function () {
    $(".top-search").hide();
  });
  $(".search-nav a").on("click", function () {
    $(".top-search").show();
  });
  //back to top
  //Check to see if the window is top if not then display button
  $(window).on("scroll", function () {
    if ($(this).scrollTop() > 300) {
      $('.scrollToTop').fadeIn();
    } else {
      $('.scrollToTop').fadeOut();
    }
  });

  //Click event to scroll to top
  $('.scrollToTop').on("click", function () {
    $('html, body').animate({
      scrollTop: 0
    }, 800);
    return false;
  });
  //animated scroll menu
  $(window).on("scroll", function () {
    var scroll = $(window).scrollTop();
    if (scroll > 0) {
      $('.navbar-transparent').addClass('shrink');
    }
    if (scroll <= 0) {
      $('.navbar-transparent').removeClass('shrink');
    }
  });
  //smooth scroll
  $(function () {
    $('.scroll-to a[href*="#"]:not([href="#"])').on("click", function () {
      if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
        if (target.length) {
          $('html, body').animate({
            scrollTop: target.offset().top
          }, 700);
          return false;
        }
      }
    });
  });
  /*****video popup **/
  $('.video-popup').magnificPopup({
    type: 'iframe'
  });
  /*****maginific popup **/
  $('.popup-container').each(function () {
    $(this).magnificPopup({
      delegate: 'a',
      type: 'image',
      mainClass: 'mfp-with-zoom',
      gallery: {
        enabled: true
      },
      zoom: {
        enabled: true,
        duration: 300,
        easing: 'ease-in-out',
        opener: function (openerElement) {
          return openerElement.is('img') ? openerElement : openerElement.find('img');
        }
      }
    });
  });
  //smooth scroll
  $(function () {
    $('.scroll-to a[href*="#"]:not([href="#"])').on("click", function () {
      if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') && location.hostname == this.hostname) {
        var target = $(this.hash);
        target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
        if (target.length) {
          $('html, body').animate({
            scrollTop: target.offset().top
          }, 500);
          return false;
        }
      }
    });
  });

  $("form#maat-contact button").click(function (event) {

    // Fetch data from input fields.
    var js_name = $("#name").val();
    var js_email = $("#email").val();
    var js_phone = $("#phone").val();
    var js_message = $("#message").val();

    event.preventDefault();

    var data = {
      'name': js_name,
      'email': js_email,
      'phone': js_phone,
      'message': js_message,
      'identity': <%= "'#{data.contact.identity}'" %>,
      'recipient': <%= "'#{data.contact.recipient}'" %>,
    };

    jQuery.ajax({
      type: 'POST',
      url: <%= "'#{data.contact.url}'" %>,
      dataType: 'json',
      contentType: 'application/json',
      data: JSON.stringify(data),
      success: function (response) {
        // clear form and show a success message
        window.location.href = "../";
      },
      error: function (xhr, ajaxOptions, thrownError) {
        // show an error message
        alert(thrownError);
      }
    });

    return false;
  });

  $("form#free2bc-signup button").on("click", function(event) {

    event.preventDefault();

    $('form#free2bc-signup input[name=HASH]').val("MY_HASH");
    $('form#free2bc-signup input[name=TIMESTAMP]').val(Date.now());

    $("form#free2bc-signup").submit();
    $("form#free2bc-signup")[0].reset();
  });

  $("form#newsletter-signup button").on("click", function(event) {

    event.preventDefault();

    $('form#newsletter-signup input[name=HASH]').val("MY_HASH");
    $('form#newsletter-signup input[name=TIMESTAMP]').val(Date.now());

    $("form#newsletter-signup").submit();
    $("form#newsletter-signup")[0].reset();
  });

  //auto close navbar-collapse on click a
  $('a.nav-link').on('click', function () {
    $('.navbar-toggler:visible').click();
  });

});
